<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" /><title>Ended year game</title>
        <script src="//cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.js"></script>
        <style type="text/css"> body { margin: 0; }</style>
    </head>


    <body>
        
        
        <script type="text/javascript">

            class Titlescreen extends Phaser.Scene {
                constructor() {
                    super("Titlescreen");
                }

                preload(){

                    //import BG
                    this.load.image("TitleScreen", "../assets/Titlescreen.png");

                    //import bouton
                    this.load.image("buttonplay", "../assets/bouton_start.png");
                    this.load.image("boutonquit", "assets/bouton_quit.png");

                    // import audio

                    this.load.audio("theme", ["sound/theme.ogg"]);
                    this.load.audio("button_sound", ["sound/click_button.ogg"]);

                    



    }

                create(){

                    //adding theme to Titlescreen
                    this.theme = this.sound.add("theme", {volume: 0.2, loop: true});
                    //this.theme.play();

                    //button_sound
                    //this.clicksound =this.sound.add("buttonsound", {loop: false});
                    //this.clicksound.play();  





                    var group = this.add.group({
                        key: 'TitleScreen',
                        frameQuantity: 32,
                        setXY: { x: 448, y: 224 },
                        //setScale: { x:2, y: 2, }
                    });
                        
                    //this.cursors = this.input.keyboard.createCursorKeys();

                    
                    //adding clickable button
                    this.buttonplay = this.add.image(750,85, "buttonplay").setInteractive();
                    this.buttonplay.on("pointerdown", function (pointer){ 
                             
                         
                    this.scene.scene.start("scene1")

                    });

                    

                   

                    this.buttonplay.setScale(1.5);

                    this. boutonquit = this.add.image(250,500, "boutonquit").setInteractive();
                    this.boutonquit.on("pointerdown", function (pointer){
                        this.scene.scene.stop("Titlescreen");
                    });

                    this.boutonquit.setScale(1.5);

                    //adding sound to button

                   

                    //this.clicksound = this.sound.add("button_sound", {loop: false});


                    
                   
                    
                    console.log("create");

                }

                update(){

                    /*if (this.cursors.space.isDown){
                        this.scene.start("scene1");
                    }*/
                 





                        } 
                click_button(){
                    this.click = new start(this)

                };
        }

            class scene1 extends Phaser.Scene {
                constructor() {
                    super("scene1");
                }
                preload() {


                    //variables

                        this.player;
                        this.playerLife = 6;
                        this.clef = false;
                        /*this.enemy;
                        this.enemy1;
                        this.enemy2;*/
                        this.piques;
                        this.cursors;
                        this.text;
                        this.themeMusic;
                        this.red_mushroom = 0;
                        this.purple_mushroom = 0 ;
                        this.yellow_mushroom = 0; this.green_mushroom = 0;
                        this.score = 0;
                        this.textHighScore;
                        this.highScore = 0;
                        this.maxTime = 60;
                        this.intialTime;
                        this.deathInMap1 = 0;



                    //importation carte        
                    this.load.tilemapTiledJSON("scene1", "LD/scene1.json");


                    //importation tileset
                    this.load.image("jeudetuile","assets/tileset_1.png");

                    //importation sprite piques + champignons + clef +  pour calques d'objets
                    this.load.image("piques_left", "assets/piques_left.png");
                    this.load.image("piques_right", "assets/piques_right.png");

                    this.load.image("purple_big_mushroom", "assets/purple_big_mushroom.png");
                    this.load.image("purple_mushroom_sol", "assets/purple_mushroom_sol.png");
                    this.load.image("purple_mushroom_left", "assets/purple_mushroom_left.png");
                    this.load.image("purple_mushroom_right", "assets/purple_mushroom_right.png");
                    this.load.image("purple_mushroom_ceilling", "assets/purple_mushroom_ceilling.png");

                    this.load.image("yellow_big_mushroom", "assets/yellow_big_mushroom.png");                    
                    this.load.image("yellow_mushroom_sol", "assets/yellow_mushroom_sol.png");
                    this.load.image("yellow_mushroom_left", "assets/yellow_mushroom_left.png");
                    this.load.image("yellow_mushroom_right", "assets/yellow_mushroom_right.png");
                    this.load.image("yellow_mushroom_ceilling", "assets/yellow_mushroom_ceilling.png");

                    this.load.image("red_big_mushroom", "assets/red_big_mushroom.png");                    
                    this.load.image("red_mushroom_sol", "assets/red_mushroom_sol.png");
                    this.load.image("red_mushroom_left", "assets/red_mushroom_left.png");
                    this.load.image("red_mushroom_right", "assets/red_mushroom_right.png");
                    this.load.image("red_mushroom_ceilling", "assets/red_mushroom_ceilling.png");

                    this.load.image("green_big_mushroom", "assets/green_big_mushroom.png");                    
                    this.load.image("green_mushroom_sol", "assets/green_mushroom_sol.png");
                    this.load.image("green_mushroom_left", "assets/green_mushroom_left.png");
                    this.load.image("green_mushroom_right", "assets/green_mushroom_right.png");
                    this.load.image("green_mushroom_ceilling", "assets/green_mushroom_ceilling.png");

                    this.load.image("clef", "assets/clef.png");
                    this.load.image("enemyWay", "assets/enemyWay.png");
                    this.load.image("door", "assets/door.ong");


                    //importation spritesheet héro
                    //animation de déplacement sur le sol, les murs et le plafond

                    this.load.image("hero", "assets/hero.png")
                    this.load.spritesheet("hero_sol_left","assets/hero_sol_left.png",
                    { frameWidth: 64, frameHeight: 64 });
                    this.load.spritesheet("hero_sol_right","assets/hero_sol_right.png",
                    { frameWidth: 64, frameHeight: 64 });
                    this.load.spritesheet("hero_plafond_left","assets/hero_plafond_left.png",
                    { frameWidth: 64, frameHeight: 64 });
                    this.load.spritesheet("hero_plafond_right","assets/hero_plafond_right.png",
                    { frameWidth: 64, frameHeight: 64 });
                    this.load.spritesheet("hero_mur_right_up","assets/hero_mur_right_up.png",
                    { frameWidth: 64, frameHeight:64});
                    this.load.spritesheet("hero_mur_right_down","assets/hero_mur_right_down.png",
                    { frameWidth: 64, frameHeight:64});
                    this.load.spritesheet("hero_mur_left_up","assets/hero_mur_left_up.png",
                    { frameWidth: 64, frameHeight:64});
                    this.load.spritesheet("hero_mur_left_down","assets/hero_mur_left_down.png",
                    { frameWidth: 64, frameHeight:64});

                    //animation dash gauche et droite


                    //importation spritesheet ennemy
                    this.load.spritesheet("ants","assets/fourmi_mob_test_1.png",
                     { frameWidth: 64, frameHeight: 64});

                    //importation barre de vie
                    this.load.image("full_hp", "assets/full_hp.png");
                    this.load.image("cinq_hp", "assets/cinq_hp.png");
                    this.load.image("quatre_hp", "assets/quatre_hp.hp");
                    this.load.image("trois_hp", "assets/trois_hp.png");
                    this.load.image("deux_hp", "assets/deux_hp.png");
                    this.load.image("un_hp", "assets/un_hp.png");
                    this.load.image("ko", "assets/ko.png");

                    //importation audio

                    this.load.audio("walking_snail", "sound/snail_laugh.mp3")

                }

                create(){

                    

                    // permet de créer la map, les collisions, et les déplacements
       
                    const carteDuNiveau = this.add.tilemap("scene1");

                    // importer les TileSet
                    const tileset = carteDuNiveau.addTilesetImage(
                    "tileset_1",
                    "jeudetuile"
                    ); 

                    const background = carteDuNiveau.createLayer(
                    "background",
                    tileset, 
                    );

                    const sol = carteDuNiveau.createLayer(
                    "sol",
                    tileset, 
                    );

                    //importation des calques d'objet purple_mushroom
                    
                    this.purple_big = this.physics.add.group();
                    this.purple_big_mushroom = carteDuNiveau.getObjectLayer('purple_big_mushroom');
                    this.purple_big_mushroom.objects.forEach(purple_big_mushroom=> {
                    const PSMushroom =  this.purple_big.create(purple_big_mushroom.x,  purple_big_mushroom.y, "purple_big_mushroom").body.setAllowGravity(false); 
                    });
                    

                    this.purple_solGroup = this.physics.add.group();
                    this.purple_mushroom_sol = carteDuNiveau.getObjectLayer('purple_mushroom_sol');
                    this.purple_mushroom_sol.objects.forEach(purple_mushroom_sol=> {
                    const PSMushroom =  this.purple_solGroup.create(purple_mushroom_sol.x,  purple_mushroom_sol.y, "purple_mushroom_sol").body.setAllowGravity(false); 
                    });

                    this.purple_leftGroup = this.physics.add.group();
                    this.purple_mushroom_left = carteDuNiveau.getObjectLayer('purple_mushroom_left');
                    this.purple_mushroom_left.objects.forEach(purple_mushroom_left=> {
                    const PLMushroom =  this.purple_leftGroup.create(purple_mushroom_left.x,  purple_mushroom_left.y, "purple_mushroom_left").body.setAllowGravity(false); 
                    });

                    this.purple_rightGroup = this.physics.add.group();
                    this.purple_mushroom_right = carteDuNiveau.getObjectLayer('purple_mushroom_right');
                    this.purple_mushroom_right.objects.forEach(purple_mushroom_right=> {
                    const PRMushroom =  this.purple_rightGroup.create(purple_mushroom_right.x,  purple_mushroom_right.y, "purple_mushroom_right").body.setAllowGravity(false); 
                     });

                    this.purple_ceillingGroup = this.physics.add.group();
                    this.purple_mushroom_ceilling = carteDuNiveau.getObjectLayer('purple_mushroom_ceilling');
                    this.purple_mushroom_ceilling.objects.forEach(purple_mushroom_ceilling=> {
                    const PCMushroom =  this.purple_ceillingGroup.create(purple_mushroom_ceilling.x,  purple_mushroom_ceilling.y, "purple_mushroom_ceilling").body.setAllowGravity(false); 
                     }); 


                    //importation calques d'objet yellow mushroom

                    this.yellow_big = this.physics.add.group();
                    this.yellow_big_mushroom = carteDuNiveau.getObjectLayer('yellow_big_mushroom');
                    this.yellow_big_mushroom.objects.forEach(yellow_big_mushroom=> {
                    const PSMushroom =  this.yellow_big.create(yellow_big_mushroom.x,  yellow_big_mushroom.y, "yellow_big_mushroom").body.setAllowGravity(false); 
                    });

                    this.yellow_solGroup = this.physics.add.group();
                    this.yellow_mushroom_sol = carteDuNiveau.getObjectLayer('yellow_mushroom_sol');
                    this.yellow_mushroom_sol.objects.forEach(yellow_mushroom_sol=> {
                    const YSMushroom =  this.yellow_solGroup.create(yellow_mushroom_sol.x,  yellow_mushroom_sol.y, "yellow_mushroom_sol").body.setAllowGravity(false); 
                    });

                    this.yellow_leftGroup = this.physics.add.group();
                    this.yellow_mushroom_left = carteDuNiveau.getObjectLayer('yellow_mushroom_left');
                    this.yellow_mushroom_left.objects.forEach(yellow_mushroom_left=> {
                    const YLMushroom =  this.yellow_leftGroup.create(yellow_mushroom_left.x,  yellow_mushroom_left.y, "yellow_mushroom_left").body.setAllowGravity(false); 
                    });

                    this.yellow_rightGroup = this.physics.add.group();
                    this.yellow_mushroom_right = carteDuNiveau.getObjectLayer('yellow_mushroom_right');
                    this.yellow_mushroom_right.objects.forEach(yellow_mushroom_right=> {
                    const YRMushroom =  this.yellow_rightGroup.create(yellow_mushroom_right.x,  yellow_mushroom_right.y, "yellow_mushroom_right").body.setAllowGravity(false); 
                    });

                    this.yellow_ceillingGroup = this.physics.add.group();
                    this.yellow_mushroom_ceilling = carteDuNiveau.getObjectLayer('yellow_mushroom_ceilling');
                    this.yellow_mushroom_ceilling.objects.forEach(yellow_mushroom_ceilling=> {
                    const YCMushroom =  this.yellow_ceillingGroup.create(yellow_mushroom_ceilling.x,  yellow_mushroom_ceilling.y, "yellow_mushroom_ceilling").body.setAllowGravity(false); 
                     }); 

                    //importation des calques red mushroom

                    this.red_big = this.physics.add.group();
                    this.red_big_mushroom = carteDuNiveau.getObjectLayer('red_big_mushroom');
                    this.red_big_mushroom.objects.forEach(red_big_mushroom=> {
                    const PSMushroom =  this.red_big.create(red_big_mushroom.x,  red_big_mushroom.y, "red_big_mushroom").body.setAllowGravity(false); 
                    });

                    this.red_solGroup = this.physics.add.group();
                    this.red_mushroom_sol = carteDuNiveau.getObjectLayer('red_mushroom_sol');
                    this.red_mushroom_sol.objects.forEach(red_mushroom_sol=> {
                    const RSMushroom =  this.red_solGroup.create(red_mushroom_sol.x,  red_mushroom_sol.y, "red_mushroom_sol").body.setAllowGravity(false); 
                    });

                    this.red_leftGroup = this.physics.add.group();
                    this.red_mushroom_left = carteDuNiveau.getObjectLayer('red_mushroom_left');
                    this.red_mushroom_left.objects.forEach(red_mushroom_left=> {
                    const RLMushroom =  this.red_leftGroup.create(red_mushroom_left.x,  red_mushroom_left.y, "red_mushroom_left").body.setAllowGravity(false); 
                    });

                    this.red_rightGroup = this.physics.add.group();
                    this.red_mushroom_right = carteDuNiveau.getObjectLayer('red_mushroom_right');
                    this.red_mushroom_right.objects.forEach(red_mushroom_right=> {
                    const RRMushroom =  this.red_rightGroup.create(red_mushroom_right.x,  red_mushroom_right.y, "red_mushroom_right").body.setAllowGravity(false); 
                     });

                    this.red_ceillingGroup = this.physics.add.group();
                    this.red_mushroom_ceilling = carteDuNiveau.getObjectLayer('red_mushroom_ceilling');
                    this.red_mushroom_ceilling.objects.forEach(red_mushroom_ceilling=> {
                    const RCMushroom =  this.red_ceillingGroup.create(red_mushroom_ceilling.x,  red_mushroom_ceilling.y, "red_mushroom_ceilling").body.setAllowGravity(false); 
                     }); 

                     //importation calques green mushroom

                    this.green_big = this.physics.add.group();
                    this.green_big_mushroom = carteDuNiveau.getObjectLayer('green_big_mushroom');
                    this.green_big_mushroom.objects.forEach(green_big_mushroom=> {
                    const PSMushroom =  this.green_big.create(green_big_mushroom.x,  green_big_mushroom.y, "green_big_mushroom").body.setAllowGravity(false); 
                    });

                    this.green_solGroup = this.physics.add.group();
                    this.green_mushroom_sol = carteDuNiveau.getObjectLayer('green_mushroom_sol');
                    this.green_mushroom_sol.objects.forEach(green_mushroom_sol=> {
                    const GSMushroom =  this.green_solGroup.create(green_mushroom_sol.x,  green_mushroom_sol.y, "green_mushroom_sol").body.setAllowGravity(false); 
                    });

                    this.green_leftGroup = this.physics.add.group();
                    this.green_mushroom_left = carteDuNiveau.getObjectLayer('green_mushroom_left');
                    this.green_mushroom_left.objects.forEach(green_mushroom_left=> {
                    const GLMushroom =  this.green_leftGroup.create(green_mushroom_left.x,  green_mushroom_left.y, "green_mushroom_left").body.setAllowGravity(false); 
                    });

                    this.green_rightGroup = this.physics.add.group();
                    this.green_mushroom_right = carteDuNiveau.getObjectLayer('green_mushroom_right');
                    this.green_mushroom_right.objects.forEach(green_mushroom_right=> {
                    const GRMushroom =  this.green_rightGroup.create(green_mushroom_right.x,  green_mushroom_right.y, "green_mushroom_right").body.setAllowGravity(false); 
                     });

                    this.green_ceillingGroup = this.physics.add.group();
                    this.green_mushroom_ceilling = carteDuNiveau.getObjectLayer('green_mushroom_ceilling');
                    this.green_mushroom_ceilling.objects.forEach(green_mushroom_ceilling=> {
                    const GCMushroom =  this.green_ceillingGroup.create(green_mushroom_ceilling.x,  green_mushroom_ceilling.y, "green_mushroom_ceilling").body.setAllowGravity(false); 
                     }); 

                    //importation calques piques

                    this.piques_rightGroup = this.physics.add.group();
                    this.piques_right = carteDuNiveau.getObjectLayer('right_piques');
                    this.piques_right.objects.forEach(piques_right=> {
                    const RPiques =  this.piques_rightGroup.create(piques_right.x,  piques_right.y, "piques_right").body.setAllowGravity(false).setImmovable(); 
                    });

                    this.piques_leftGroup = this.physics.add.group();
                    this.piques_left = carteDuNiveau.getObjectLayer('left_piques');
                    this.piques_left.objects.forEach(piques_left=> {
                    const LPiques =  this.piques_leftGroup.create(piques_left.x,  piques_left.y, "piques_left").body.setAllowGravity(false).setImmovable(); 
                    });

                    //importation clef                    

                    this.clef_Group = this.physics.add.group();
                    this.clef = carteDuNiveau.getObjectLayer('clef');
                    this.clef.objects.forEach(clef=> {
                    const key =  this.clef_Group.create(clef.x,  clef.y, "clef").body.setAllowGravity(false); 
                    });


                    /*this.door_group = this.physics.add.group();
                    this.door = carteDuNiveau.getObjectLayer('door');
                    this.door.objects.forEach(door =>{
                        const door = this.door_group.create(door.x, door.y, "door");
                    });
                    //importation enemy

                    this.enemy_group = this.physics.add.group();
                    this.ants = carteDuNiveau.getObjectLayer('enemy');
                    this.ants.objects.forEach(ants=> {
                        const enemy = this.enemy_group.create(ants.x, ants.y, "ants");
                    });*/
                    

                    /*his.enemyWayGroup = this.physics.add.group();
                    this.enemyWay = carteDuNiveau.getObjectLayer('enemyWay');
                    this.enemyWay.objects.forEach(enemyWay=> {
                        const Way = this.enemyWayGroup.create(enemyWay.x, enemyWay.y, "enemyWay").body.setAllowGravity(false);
                    });*/

                    
                   const door = carteDuNiveau.createLayer(
                        "door",
                        tileset,
                    );

                    const grass = carteDuNiveau.createLayer(
                        "grass",
                        tileset, 
                    );

                    const trees = carteDuNiveau.createLayer(
                        "trees",  
                        tileset,
                    );

                    //set collision by property                    

                    sol.setCollisionByProperty({ collider: true });
                    door.setCollisionByProperty({ collider: true });
                      
                    //création caméra
                    this.cameras.main.setSize(896, 448); 

                    this.player = this.physics.add.sprite(200, 6144, "hero")/*.setOrigin(128,128)*/;
                    this.player.setCollideWorldBounds(true);
                    
                    
                     
                    //this.player.setGravity(300)
                    this.physics.add.collider(this.player, sol);
                    this.door = this.physics.add.collider(this.player, door);
                    this.physics.add.collider(this.player, this.piques_rightGroup, this.playerSpiked, null, this);
                    this.physics.add.collider(this.player, this.piques_leftGroup, this.playerSpiked, null, this);



                    // overlap des champignons

                    this.physics.add.overlap(this.purple_ceillingGroup,this.player,this.collectPurpleChamp,null,this);
                    this.physics.add.overlap(this.purple_leftGroup, this.player, this.collectPurpleChamp,null,this);
                    this.physics.add.overlap(this.purple_rightGroup,this.player,this.collectPurpleChamp,null,this);
                    this.physics.add.overlap(this.purple_solGroup, this.player, this.collectPurpleChamp,null,this);
                                        
                    this.physics.add.overlap(this.yellow_ceillingGroup,this.player,this.collectYellowChamp,null,this);
                    this.physics.add.overlap(this.yellow_leftGroup, this.player, this.collectYellowChamp,null,this);
                    this.physics.add.overlap(this.yellow_rightGroup,this.player,this.collectYellowChamp,null,this);
                    this.physics.add.overlap(this.yellow_solGroup, this.player, this.collectYellowChamp,null,this);
                                        
                    this.physics.add.overlap(this.red_ceillingGroup,this.player,this.collectRedChamp,null,this);
                    this.physics.add.overlap(this.red_leftGroup, this.player, this.collectRedChamp,null,this);
                    this.physics.add.overlap(this.red_rightGroup,this.player,this.collectRedChamp,null,this);
                    this.physics.add.overlap(this.red_solGroup, this.player, this.collectRedChamp,null,this);
                                        
                    this.physics.add.overlap(this.green_ceillingGroup, this.player, this.collectGreenChamp, null, this);
                    this.physics.add.overlap(this.green_leftGroup, this.player, this.collectGreenChamp, null, this);
                    this.physics.add.overlap(this.green_rightGroup, this.player, this.collectGreenChamp, null, this);
                    this.physics.add.overlap(this.green_solGroup, this.player, this.collectGreenChamp, null, this);

                    this.physics.add.overlap(this.purple_big, this.player, this.collectPurpleChamp, null, this);
                    this.physics.add.overlap(this.yellow_big, this.player, this.collectYellowChamp, null, this);
                    this.physics.add.overlap(this.red_big, this.player, this.collectRedChamp, null, this);
                    this.physics.add.overlap(this.green_big, this.player, this.collectGreenChamp, null, this)

                    //enemy collider

                    //this.physics.add.collider(this.enemy, this.sol);

                    //overlap clef

                    this.physics.add.overlap(this.clef_Group, this.player, this.collectKey, null, this);
                    
                    //importation des entrées clavier

                    this.cursors = this.input.keyboard.createCursorKeys();

                    //animation joueur

                    this.anims.create({
                    key: 'sol_left',
                    frames: this.anims.generateFrameNumbers('hero_sol_left', {start:0,end:3}),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: 'sol_right',
                    frames: this.anims.generateFrameNumbers('hero_sol_right', {start:0,end:3}),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: 'mur_left_up',
                    frames: this.anims.generateFrameNumbers('hero_mur_left_up', {start:0,end:3}),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: 'mur_left_down',
                    frames: this.anims.generateFrameNumbers('hero_mur_left_down', {start:0,end:3}),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: 'mur_right_up',
                    frames: this.anims.generateFrameNumbers('hero_mur_right_up', {start:0,end:3}),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: 'mur_right_down',
                    frames: this.anims.generateFrameNumbers('hero_mur_right_down', {start:0,end:3}),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: 'plafond_left',
                    frames: this.anims.generateFrameNumbers('hero_plafond_left', {start:0,end:3}),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: 'plafond_right',
                    frames: this.anims.generateFrameNumbers('hero_plafond_right', {start:0,end:3}),
                    frameRate: 10,
                    repeat: -1
                    });

                    this.anims.create({
                    key: 'hero',
                    frames: [ { key: 'hero_sol_right'} ],
                    frameRate: 20
                    });
                    
                    //ajout sprite adverssaire

                    /*enemy = this.physics.add.sprite(2200, 500, "walkingEnemy");
                    enemy.setBounce(.1);

                    enemy1 = this.physics.add.sprite(2190, 669, "walkingEnemy");
                    enemy1.setBounce(.1);


                    enemy2 = this.physics.add.sprite(1705, 600, "walkingEnemy");
                    enemy2.setBounce(.1);


                    enemy3 = this.physics.add.sprite(390, 560, "walkingEnemy");
                    enemy3.setBounce(.1);*/

                    



                    // caméra 

                    this.cameras.main.setBounds(0,0,6336,6336);
                    this.cameras.main.startFollow(this.player);
                    this.physics.world.setBounds(0,0,6336,6336);

                    var walking_snail = this.sound.add('walking_snail')
         
                                        
                    }


                update() {
                    if (this.playerLife == 0 || this.playerLife < 0) {
                        this.time.addEvent({
                            delay: 1000,
                            callback: () => {
                            //this.themeMusic.stop();
                            this.input.keyboard.enabled = true;
                            this.scene.start[scene1];
                            },

                        });
                    }
                   
                    if (this.cursors.left.isDown){ //si la touche gauche est appuyée
                        this.player.setVelocityX(-160); //alors vitesse négative en X
                        this.player.anims.play('sol_left', true); //et animation => gauche
                        }
                        else if (this.cursors.right.isDown){ //sinon si la touche droite est appuyée
                        this.player.setVelocityX(160); //alors vitesse positive en X
                        this.player.anims.play('sol_right', true); //et animation => droite
                        }
                        else{ // sinon
                        this.player.setVelocityX(0); //vitesse nulle
                        this.player.anims.play('hero'); //animation fait face caméra
                    }
                    if (this.player.body.onFloor()) {
                        
                        if (this.cursors.up.isDown && this.player.body.onFloor()){
                        //si touche haut appuyée ET que le perso touche le sol
                        this.player.setVelocityY(-330); //alors vitesse verticale négative
                        //(on saute)
                        }
                        
                    }

                    if (this.player.body.onWall()) {

                        if (this.cursors.up.isDown && this.player.body.onWall()){
                        //si touche haut appuyée ET que le perso touche le sol
                        this.player.setVelocityY(-160); //alors vitesse verticale négative
                        if(this.player.body.blocked.left){
                            this.player.anims.play('mur_left_up');
                        }else{
                            this.player.anims.play('mur_right_up');
                        }
                        if(this.player.body.velocity.y > 0){
                            if(this.player.body.blocked.left){
                                this.player.anims.play('mur_left_down');
                            }else{
                                this.player.anims.play('mur_right_down');
                            }
                        }
                       
                        //(on saute)
                        }
                    }


                    if (this.player.body.onCeiling()) {

                        
                        if (this.cursors.right.isDown && this.player.body.onCeiling()){
                        //si touche haut appuyée ET que le perso touche le sol
                        this.player.setVelocityY(-160); //alors vitesse verticale négative
                        this.player.anims.play('plafond_right');
                        
                        }

                        if (this.cursors.left.isDown && this.player.body.onCeiling()){
                        //si touche haut appuyée ET que le perso touche le sol
                        this.player.setVelocityY(-160); //alors vitesse verticale négative
                        this.player.anims.play('plafond_left');
                        
                        }

                        
                     
                        
                    }

                    
                  
                }

                //retour la collision avec les murs left ou right

                onWall()
                {
                    return (this.blocked.left || this.blocked.right);
                }

                //retourne la collision avec les murs up

                onCeiling()
                {
                    return this.blocked.up;
                }

                //déclenche la perte de point de vie en cas de contact avec les piques

                playerSpiked(player, playerLife) {
                    //this.playerDieSound.play();
                    //this.themeMusic.stop();
                    //this.input.keyboard.enabled = false;
                    //this.player.body.setVelocityY(-2000);
                    this.playerLife -= 1;
                    if(this.playerLife == 6){
                        this.playerLife -= 1
                        console.log("5 hp")
                        this.scene.start( "scene1");
                    }

                    else if (this.playerLife == 5){
                        this.playerLife -= 1
                        console.log("4 hp")
                        this.scene.start ("scene1");
                    }
                    else if (this.playerLife == 4){
                        this.playerLife -= 1
                        console.log("3hp")
                        this.scene.start("scene1");
                    }
                    else if (this.playerLife == 3){
                        this.playerLife -= 1
                        console.log("2 hp")
                        this.scene.start[scene1];
                    }
                    else if (this.playerLife == 2){
                        this.playerLife -= 1
                        console.log("1 hp")
                        this.scene.start[scene1];
                    }
                    else if (this.playerLife == 1){
                        console.log("dead")
                        this.scene.start("Titlescreen");
                    }
                    console.log('playerLife:', this.playerLife);
                    
                }

                //déclenche la mort des enemy par le joueur lorsqu'on leur saute dessus

                playerDied(player, enemy, enemy1, enemy2, enemy3) {

                    if (enemy.body.touching.up) {
                        this.enemyDieSound.play()
                        this.enemy.destroy();
                        this.score += 20;
                        this.text.setText("Score" +
                        this.score);
                        this.player.body.setVelocityY(-500);
                    } else {
                        this.themeMusic.stop();
                        this.input.keyboard.enabled = false;
                        this.player.body.collideWorldBounds = false;
                        this.player.body.setVelocityY(-2000);
                        console.log("player died");
                        this.this.playerDieSound.play();

                        this.playerLife -= 1;
                        this.console.log('playerLife:', playerLife);
                        console.log("enemy 0 killed player")
                        this.time.addEvent({
                            delay: 1000,
                            callback: () => {
                                this.input.keyboard.enabled = true;
                                this.scene.start('death');
                            },

                        });


                    }

                    if (enemy1.body.touching.up) {
                        enemy1.destroy();
                        score += 20;
                        text.setText("Score" +
                            score);
                        player.body.setVelocityY(-250);
                    } else {
                        this.themeMusic.stop();
                        player.body.setVelocityY(-250);
                        console.log("enemy 1 killed player")
                        playerLife -= 1;
                        console.log('playerLife:', playerLife);
                        console.log("player died");
                        this.playerDieSound.play();

                        this.time.addEvent({
                            delay: 1000,
                            callback: () => {
                                this.scene.start('death');
                            },

                        });

                    }

                    if (enemy2.body.touching.up) {
                        enemy2.destroy();
                        score += 20;
                        text.setText("Score" +
                            score);
                        player.body.setVelocityY(-250);
                    } else {
                        this.themeMusic.stop();
                        player.body.setVelocityY(-250);
                        console.log("enemy 2 killed player")
                        playerLife -= 1;
                        console.log('playerLife:', playerLife);
                        console.log("player died");
                        this.playerDieSound.play();
                        this.time.addEvent({
                            delay: 1000,
                            callback: () => {
                                this.scene.start('death');
                            },

                        });

                    }

                    if (enemy3.body.touching.up) {
                        enemy3.destroy();
                        score += 20;
                        text.setText("Score" +
                            score);
                        player.body.setVelocityY(-250);
                    } else {
                        this.themeMusic.stop();
                        player.body.setVelocityY(-250);
                        player.input.enabled = false;
                        console.log("enemy 3 killed player")
                        playerLife -= 1;
                        console.log('playerLife:', playerLife);
                        console.log("player died");
                        this.playerDieSound.play();
                        this.time.addEvent({
                            delay: 1000,
                            callback: () => {
                                this.scene.start('death');
                            },

                        });
                    }


                    //this.themeMusic.stop();
                    player.body.setVelocityY(-250);
                    console.log("someone killed player")

                    this.time.addEvent({
                        delay: 1000,
                        callback: () => {
                            this.scene.start('death');
                        },

                    });

                    }

                    enemyCollidedLeft() {
                        console.log('enemy collided left')
                        enemy.body.setVelocityX(-1500);
                        enemy.flipX = true;
                    }

                    enemyCollidedRight() {
                        console.log('enemy collided right')
                        enemy.body.setVelocityX(+1500);
                        enemy.flipX = false;

                    }


                    enemyCollidedLeft1() {
                        console.log('enemy1 collided left1')
                        enemy1.body.setVelocityX(-500);
                        enemy1.flipX = true;
                    }

                    enemyCollidedRight1() {
                        console.log('enemy1 collided right1')
                        enemy1.body.setVelocityX(+500);
                        enemy1.flipX = false;

                    }

                    enemyCollidedLeft2() {
                        console.log('enemy2 collided yes')
                        enemy2.body.setVelocityX(+1000);
                        enemy2.flipX = false;
                    }

                    enemyCollidedRight2() {
                        console.log('enemy2 collided right2')
                        enemy2.body.setVelocityX(-1000);
                        enemy2.flipX = true;

                    }




                    //collect purple champ

                    collectPurpleChamp(player, champ) {

                        //this.purple_ceillingGroup.removeTileAt(this.gros_champ.x, this.gros_champ.y); // remove the tile/coin
                        //score++; // add 10 points to the score
                        console.log("purple champ")
                        champ.destroy()
                        //this.collectChamp.play();
                        //text.setText("Score" +
                        //    score);
                        // set the text to show the current score
                        return false;

                    }

                    //collect Yellow champ

                    collectYellowChamp(player, champ) {

                    //this.purple_ceillingGroup.removeTileAt(this.gros_champ.x, this.gros_champ.y); // remove the tile/coin
                    //score++; // add 10 points to the score
                    console.log(" yellow champ")
                    champ.destroy()
                    //this.collectChamp.play();
                    //text.setText("Score" +
                    //    score);
                    // set the text to show the current score
                    return false;
                    }

                    //collect Red champ

                    collectRedChamp(player, champ) {

                    //this.purple_ceillingGroup.removeTileAt(this.gros_champ.x, this.gros_champ.y); // remove the tile/coin
                    //score++; // add 10 points to the score
                    console.log(" red champ")
                    champ.destroy()
                    //this.collectChamp.play();
                    //text.setText("Score" +
                    //    score);
                    // set the text to show the current score
                    return false;
                    }

                    //collect green champ

                    collectGreenChamp(player, champ) {

                    //this.purple_ceillingGroup.removeTileAt(this.gros_champ.x, this.gros_champ.y); // remove the tile/coin
                    //score++; // add 10 points to the score
                    console.log(" green champ")
                    champ.destroy()
                    //this.collectChamp.play();
                    //text.setText("Score" +
                    //    score);
                    // set the text to show the current score
                    return false;
                    }

                    //collect key

                    collectKey(player, clef) {

                        clef.destroy(this.clef = true)
                        console.log("key")

                        // openDoor(clef, door){
                        this.physics.world.removeCollider(this.door)
                        console.log("door")

                       return true;
                    }

                    /*setActive()
                    {
                        this.active = ;

                        return this;
                    }*/



            }

            /*class Game_over extends Phaser.Scene {
                constructor() {
                    super("Game_over");
                }

                preload(){
                     //import BG
                    this.load.image("game_over", "../assets/game_over.png");

                    //import bouton
                    this.load.image("retry", "../assets/retry.png");

                    //import sound ? 

                }

                create(){

                    
                    var group = this.add.group({
                        key: 'TitleScreen',
                        frameQuantity: 32,
                        setXY: { x: 448, y: 224 },
                        //setScale: { x:2, y: 2, }
                    });
                        
                    
                    
                    //adding clickable button
                    this.buttonplay = this.add.image(750,85, "buttonplay").setInteractive();
                    this.buttonplay.on("pointerdown", function (pointer){
                                      
                    this.scene.scene.start("scene1")

                    });

                }

                update(){

                }




            }*/





        

            var config = {
                type: Phaser.AUTO,
                width: 896,
                height: 448,
                parent: 'phaser-example',
                physics: {
                    default: 'arcade',
                    arcade: {
                        debug: true,
                        gravity: { y: 400 }
                    }
                },
            scene : [Titlescreen, scene1, ] //Titlescreen scene2 scene3 death win à rajouter au début  
            };
                new Phaser.Game(config);





        </script>

    </body>